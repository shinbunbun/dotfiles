# RouterOS 利用可能OID一覧

このドキュメントは、MikroTik RouterOSで利用可能だが現在実装されていないSNMP OIDとその機能をまとめたものです。

## 1. システム情報 (1.3.6.1.4.1.14988.1.1.7)

デバイスの基本情報を取得するためのOIDです。

| OID | 名前 | 説明 | 現在の値の例 |
|-----|------|------|--------------|
| .3.0 | mtxrSerialNumber | デバイスのシリアル番号 | "BEC50BE416D7" |
| .4.0 | mtxrFirmwareVersion | ファームウェアバージョン | "6.49.18" |
| .6.0 | mtxrBuildTime | ビルド日時 | "2025-06-20 07:55:02" |
| .7.0 | mtxrFirmwareUpgradeVersion | 利用可能なアップグレードバージョン | "7.19.2" |
| .8.0 | mtxrBoardName | ボード名 | "hAP ac" |
| .9.0 | mtxrModel | モデル名 | "RB962UiGS-5HacT2HnT" |

## 2. ライセンス情報 (1.3.6.1.4.1.14988.1.1.12)

RouterOSのライセンス状態を監視するためのOIDです。

| OID | 名前 | 説明 |
|-----|------|------|
| .1.0 | mtxrLicLevel | ライセンスレベル |
| .2.0 | mtxrLicVersion | ライセンスバージョン |
| .6.0 | mtxrLicUpgradeableTo | アップグレード可能なレベル |

## 3. システムヘルス情報 (1.3.6.1.4.1.14988.1.1.13)

システムの健全性を監視するためのOIDです。

| OID | 名前 | 説明 | 重要度 |
|-----|------|------|--------|
| .10.0 | mtxrSystemRebootCount | システム再起動回数 | 高 |
| .11.0 | mtxrSystemBadBlockCount | 不良ブロック数 | 高 |
| .12.0 | mtxrUSBPowerResetCount | USB電源リセット回数 | 中 |

## 4. インターフェース統計 (1.3.6.1.4.1.14988.1.1.14)

標準のインターフェース統計に加えて、ドライバレベルの詳細な統計を提供します。

| OID | 名前 | 説明 |
|-----|------|------|
| .1.1.1 | mtxrInterfaceStatsIndex | インターフェースインデックス |
| .1.1.2 | mtxrInterfaceStatsName | インターフェース名 |
| .1.1.11 | mtxrInterfaceStatsDriverRxBytes | ドライバ受信バイト数 |
| .1.1.12 | mtxrInterfaceStatsDriverRxPackets | ドライバ受信パケット数 |
| .1.1.13 | mtxrInterfaceStatsDriverTxBytes | ドライバ送信バイト数 |
| .1.1.14 | mtxrInterfaceStatsDriverTxPackets | ドライバ送信パケット数 |

利用可能なインターフェース:
- ether1-5: 有線LANポート
- sfp1: SFPポート
- wlan1-2: 無線LANインターフェース
- bridge: ブリッジインターフェース
- pppoe-out1: PPPoE接続
- wg-home: WireGuard VPN

## 5. ハードウェアモニター拡張 (1.3.6.1.4.1.14988.1.1.3.100)

追加のハードウェアセンサー情報を提供します。

| OID | 名前 | 説明 | 現在の値の例 |
|-----|------|------|--------------|
| .1.2.13 | センサー名 | "voltage" | - |
| .1.3.13 | 電圧値 | 追加の電圧センサー | 24.3V (値: 243) |
| .1.2.14 | センサー名 | "temperature" | - |
| .1.3.14 | 温度値 | 追加の温度センサー | 44°C |

## 6. ルーティングテーブル統計 (1.3.6.1.4.1.14988.1.1.1.3)

BGPやOSPFなどの動的ルーティングプロトコルの統計情報です。

| OID範囲 | 説明 | 用途 |
|---------|------|------|
| .1.2.x | BGPパス数 | BGP使用時のパス数監視 |
| .1.3.x | BGPピア状態 | BGPピアの接続状態 |
| .1.4.x | BGPピア名 | BGPピアの識別 |
| .1.10.x | 受信プレフィックス数 | ルーティング情報の規模監視 |
| .1.11.x | 送信プレフィックス数 | 広告ルート数の監視 |

## 7. ネイバーテーブル (1.3.6.1.4.1.14988.1.1.1.10)

ARPおよびIPv6ネイバーディスカバリの情報です。

| OID | 名前 | 説明 |
|-----|------|------|
| .0 | mtxrNeighborCount | ネイバー数 |

## 8. 接続デバイス情報（標準MIB）

### ARPテーブル (1.3.6.1.2.1.4.22)

ネットワーク上のアクティブなデバイスのIPアドレスとMACアドレスのマッピングを提供します。

| OID | 名前 | 説明 | 例 |
|-----|------|------|-----|
| .1.1 | ipNetToMediaIfIndex | インターフェースインデックス | 9 (bridge) |
| .1.2 | ipNetToMediaPhysAddress | MACアドレス | "3c:84:6a:c1:91:2c" |
| .1.3 | ipNetToMediaNetAddress | IPアドレス | "192.168.1.2" |
| .1.4 | ipNetToMediaType | エントリタイプ | dynamic(3) |

### ブリッジ転送テーブル (1.3.6.1.2.1.17.4.3)

スイッチングされているMACアドレスとポート情報を提供します。

| OID | 名前 | 説明 |
|-----|------|------|
| .1.1 | dot1dTpFdbAddress | 学習されたMACアドレス |
| .1.2 | dot1dTpFdbPort | MACアドレスが接続されているポート番号 |
| .1.3 | dot1dTpFdbStatus | エントリの状態 |

### DHCP情報 (1.3.6.1.4.1.14988.1.1.6)

| OID | 名前 | 説明 | 現在値 |
|-----|------|------|--------|
| .1.0 | mtxrDHCPLeaseCount | アクティブなDHCPリース数 | 14 |

## 実装推奨度

### 高優先度
1. **システム情報OID** - デバイス識別とファームウェア管理に必須
2. **インターフェース統計OID** - より詳細なトラフィック分析が可能
3. **システムヘルス情報** - 再起動回数や不良ブロックの監視で障害予防
4. **接続デバイス情報** - ネットワーク上のデバイス監視とトラブルシューティング

### 中優先度
1. **ハードウェアモニター拡張** - 追加のセンサー情報で詳細な状態監視
2. **ライセンス情報** - ライセンス期限やレベルの管理

### 低優先度
1. **ルーティングテーブル統計** - BGP/OSPF使用環境でのみ有用
2. **ネイバーテーブル** - ネットワークトポロジー把握用

## 実装時の注意事項

1. **パフォーマンスへの影響**
   - 大量のOIDを追加するとSNMPポーリングの負荷が増加
   - 必要最小限のOIDのみを選択的に実装

2. **データ保存期間**
   - 詳細な統計データは容量を消費するため、適切な保存期間設定が必要

3. **アラート設定**
   - システム再起動回数の急激な増加
   - 不良ブロック数の増加
   - ライセンス期限切れの事前通知

## 実装例

```yaml
# snmp.ymlへの追加例
modules:
  mikrotik:
    walk:
    # 既存のOID...
    - 1.3.6.1.4.1.14988.1.1.7     # システム情報
    - 1.3.6.1.4.1.14988.1.1.13    # システムヘルス
    - 1.3.6.1.4.1.14988.1.1.14    # インターフェース統計
    - 1.3.6.1.4.1.14988.1.1.3.100 # ハードウェアモニター拡張
    - 1.3.6.1.2.1.4.22           # ARPテーブル（接続デバイス）
    - 1.3.6.1.2.1.17.4.3         # ブリッジ転送テーブル
    - 1.3.6.1.4.1.14988.1.1.6    # DHCP統計
```

## 接続デバイス監視の活用例

### Grafanaダッシュボードでの表示例
1. **接続デバイス一覧テーブル**
   - IPアドレス、MACアドレス、接続ポート、最終確認時刻

2. **デバイス接続数の推移グラフ**
   - ARPエントリ数やDHCPリース数の時系列変化

3. **新規デバイス接続アラート**
   - 未知のMACアドレスが検出された場合の通知

### Prometheusクエリ例
```promql
# アクティブなデバイス数
count(ipNetToMediaPhysAddress{job="routeros"})

# 特定のMACアドレスの監視
ipNetToMediaPhysAddress{job="routeros",ipNetToMediaPhysAddress="3c:84:6a:c1:91:2c"}
```

## 参考資料

- [MikroTik公式Wiki - SNMP](https://wiki.mikrotik.com/wiki/Manual:SNMP)
- [MikroTik MIBファイル](https://mikrotik.com/download)
- [SNMP OID Reference](http://oidref.com/1.3.6.1.4.1.14988)